<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingredient Optimizer</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: Arial, sans-serif;
        }
        .container {
            margin-top: 50px;
        }
        .form-container {
            background-color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
        }
        .modal-body pre {
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="text-center mb-4">Ingredient Optimizer</h1>
        <div class="form-container">
            <form id="optimizerForm">
                <div class="mb-3">
                    <label for="ingredients" class="form-label">Ingredients</label>
                    <textarea id="ingredients" class="form-control" rows="3" placeholder="Enter ingredients separated by commas"></textarea>
                </div>
                <div class="mb-3">
                    <label for="dietaryPreferences" class="form-label">Dietary Preferences</label>
                    <input type="text" id="dietaryPreferences" class="form-control" placeholder="e.g., Vegan, Gluten-Free">
                </div>
                <div class="mb-3">
                    <label for="healthGoals" class="form-label">Health Goals</label>
                    <input type="text" id="healthGoals" class="form-control" placeholder="e.g., Weight Loss, Muscle Gain">
                </div>
                <div class="mb-3">
                    <label for="calorieLimit" class="form-label">Calorie Limit</label>
                    <input type="number" id="calorieLimit" class="form-control" placeholder="Enter calorie limit">
                </div>
                <button type="button" class="btn btn-primary" id="submitButton">Optimize Ingredients</button>
            </form>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="responseModal" tabindex="-1" aria-labelledby="responseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="responseModalLabel">Optimized Recipe</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <pre id="responseContent"></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
document.getElementById('submitButton').addEventListener('click', async () => {
    const ingredients = document.getElementById('ingredients').value.split(',').map(ing => ing.trim());
    const dietaryPreferences = document.getElementById('dietaryPreferences').value;
    const healthGoals = document.getElementById('healthGoals').value;
    const calorieLimit = parseInt(document.getElementById('calorieLimit').value, 10);

    const requestBody = {
        ingredients,
        dietary_preferences: dietaryPreferences,
        health_goals: healthGoals,
        calorie_limit: calorieLimit
    };

    try {
        const response = await fetch('http://localhost:8001/aiSystem/optimize-ingredients/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(requestBody)
        });

        if (!response.ok) throw new Error('Failed to fetch data from API');

        const responseData = await response.json();

        // Parse and format the response for user-friendly display
        const recipes = responseData.recipes || [];
        let formattedResponse = '';

        recipes.forEach((recipe, index) => {
            formattedResponse += `
                <h4>Recipe ${index + 1}: ${recipe.name}</h4>
                <p>${recipe.instructions}</p>
                <hr>
            `;
        });

        document.getElementById('responseContent').innerHTML = formattedResponse;

        const responseModal = new bootstrap.Modal(document.getElementById('responseModal'));
        responseModal.show();
    } catch (error) {
        alert(`Error: ${error.message}`);
    }
});

    </script>
</body>
</html>
